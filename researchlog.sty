% researchlog.sty - 通用科研日志样式 (模板版本)
% 复制到新项目并按需修改
% 作者: 请填写
% 创建日期: 2025-11-12

\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{researchlog}[2025/11/09 Research Log Template Style]

% 基础宏包
\RequirePackage{geometry}
\RequirePackage{fancyhdr}
\RequirePackage{titlesec}
\RequirePackage{xcolor}
\RequirePackage{framed}
\RequirePackage{amssymb}
\RequirePackage{datetime}
% 条件性加载 hyperref：如果用户在主文件中已加载并传递选项，这里不重复加载选项以避免冲突
\makeatletter
\@ifpackageloaded{hyperref}{}{\RequirePackage{hyperref}}
\makeatother
\RequirePackage{graphicx}
\RequirePackage{listings}
\RequirePackage{enumitem}
\RequirePackage{booktabs}

% 可配置选项 (用户可在导言区重定义)
\providecommand{\logTitle}{科研日志}
\providecommand{\logAuthor}{作者}
\providecommand{\logDate}{\today}

% 目录深度
\setcounter{tocdepth}{2}

% 页面设置
\geometry{
    a4paper,
    left=2.5cm,
    right=2.5cm,
    top=3cm,
    bottom=3cm
}

% 颜色定义
\definecolor{logblue}{RGB}{0,102,204}
\definecolor{loggray}{RGB}{128,128,128}
\definecolor{loggreen}{RGB}{0,128,0}
\definecolor{logorange}{RGB}{255,140,0}
\definecolor{logpurple}{RGB}{128,0,128}

% 页眉页脚
\pagestyle{fancy}
\fancyhf{}
\fancyhead[L]{\textcolor{logblue}{\textbf{\logTitle}}}
\fancyhead[R]{\textcolor{loggray}{\logDate}}
\fancyfoot[C]{\thepage}
\renewcommand{\headrulewidth}{0.5pt}
\renewcommand{\footrulewidth}{0.5pt}

% 标题格式
\titleformat{\section}
    {\Large\bfseries\color{logblue}}
    {\thesection}{1em}{}
\titleformat{\subsection}
    {\large\bfseries\color{logblue}}
    {\thesubsection}{1em}{}

% 日志条目环境
\newenvironment{logentry}[1]{%
    \vspace{0.5em}
    \noindent{\Large\textcolor{logblue}{\textbf{#1}}}
    % 将日志条目加入目录，作为 subsection
    % \addcontentsline{toc}{subsection}{#1}
    \vspace{0.3em}
    \hrule
    \vspace{0.3em}
}{%
    \vspace{0.5em}
    \hrule
    \vspace{1em}
    \par\noindent\newpage
}

% 常用子环境
\newenvironment{work}{%
    \vspace{0.3em}
    \noindent{\large\textcolor{loggreen}{\textbf{工作记录}}}
    \vspace{0.2em}
    \par
}{%
    \vspace{0.3em}
}

\newenvironment{goal}{%
    \vspace{0.3em}
    \noindent{\large\textcolor{logorange}{\textbf{今日目标}}}
    \vspace{0.2em}
    \par
}{%
    \vspace{0.3em}
}

\newenvironment{todo}{%
    \vspace{0.3em}
    \noindent{\large\textcolor{red}{\textbf{待办事项}}}
    \vspace{0.2em}
    \par
}{%
    \vspace{0.3em}
}

\newenvironment{tomorrow}{%
    \vspace{0.3em}
    \noindent{\large\textcolor{logpurple}{\textbf{明日计划}}}
    \vspace{0.2em}
    \par
}{%
    \vspace{0.3em}
}

% 快速命令
\newcommand{\logdate}[1]{\textcolor{logblue}{\textbf{#1}}}
\newcommand{\important}[1]{\textcolor{red}{\textbf{#1}}}
\newcommand{\note}[1]{\textcolor{loggray}{\textit{#1}}}
\newcommand{\highlight}[1]{\colorbox{yellow!30}{#1}}
\newcommand{\keyword}[1]{\textcolor{logblue}{\texttt{#1}}}

% 代码样式
\lstset{
    basicstyle=\ttfamily\small,
    breaklines=true,
    frame=single,
    numbers=left,
    numberstyle=\tiny\color{loggray},
    keywordstyle=\color{logblue},
    commentstyle=\color{loggreen},
    stringstyle=\color{red},
    backgroundcolor=\color{gray!5}
}

\endinput
